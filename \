Here's the organized and fixed version of your configuration, with useful comments retained:

```nix
{ pkgs, lib, user, config, ... }:

{
  environment = {
    sessionVariables.GTK_THEME = "Adwaita:dark";
    systemPackages = with pkgs; [
      bspwm
      sxhkd
      rofi
      polybar
      feh
      alacritty
      dunst
      libnotify
      maim
      papirus-icon-theme # Icons for rofi
      xclip
      picom
      playerctl
      wireplumber # For PulseWire
      bc # For brightnessctl
      (nerdfonts.override { fonts = [ "JetBrainsMono" ]; })
    ];
  };

  qt = {
    enable = true;
    platformTheme = "gnome";
    style = "adwaita-dark";
  };

  services = {
    displayManager = {
      defaultSession = "none+bspwm";
      gdm.enable = true;
    };
    redshift.enable = false;
    libinput.enable = true; # Better support for general peripherals
    xserver = {
      enable = true;
      dpi = 96;
      autoRepeatDelay = 200;
      autoRepeatInterval = 45;
      windowManager.bspwm.enable = true;
      videoDrivers = [ "nvidia" ];
      # This helps fix tearing of windows for Nvidia cards
      screenSection = ''
        Option       "metamodes" "nvidia-auto-select +0+0 {ForceFullCompositionPipeline=On}"
        Option       "AllowIndirectGLXProtocol" "off"
        Option       "TripleBuffer" "on"
      '';
    };
    acpid.enable = true;
  };

  hardware.nvidia = {
    modesetting.enable = true;
    # Nvidia power management. Experimental, and can cause sleep/suspend to fail.
    powerManagement = {
      enable = false;
      finegrained = false; # Experimental and only works on modern Nvidia GPUs (Turing or newer).
    };
    # Use the NVidia open source kernel module (not to be confused with the
    # independent third-party "nouveau" open source driver).
    open = false;
    nvidiaSettings = true;
    package = config.boot.kernelPackages.nvidiaPackages.stable;
  };

  home-manager.users.${user} = { pkgs, lib, config, ... }: {
    home.keyboard = {
      layout = "us";
    };
  };

  # Uncomment and adjust if you want to use redshift
  # services.redshift = {
  #   enable = true;
  #   temperature = {
  #     day = 5500;
  #     night = 3700;
  #   };
  #   brightness = {
  #     day = "1";
  #     night = "0.8";
  #   };
  #   extraOptions = [
  #     "-v"
  #     "-m randr"
  #   ];
  # };

  # Uncomment if you want to use LightDM instead of GDM
  # services.xserver.displayManager.lightdm = {
  #   enable = true;
  #   greeters.slick.enable = true;
  #   defaultSession = "none+bspwm";
  #   background = ../../../modules/shared/assets/wallpaper/login-wallpaper.png;
  # };
}
```

This configuration:
1. Organizes related settings into logical groups.
2. Retains important comments about NVIDIA settings and other options.
3. Keeps the Redshift and LightDM configurations as commented-out options for easy enabling if needed.
4. Simplifies the structure where possible while maintaining all functionality.

Remember to adjust any paths or specific settings as needed for your system.
